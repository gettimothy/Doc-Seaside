# Table of Contents1.  [Seaside](#org6e17110)    1.  [Introduction](#org0108259)    2.  [Followups](#orgdd7e9e4)    3.  [Codecs](#org241f544)        1.  [GRCodec](#org1bec414)        2.  [GRNullCodec](#org2d8bc93)        3.  [GRGenericCodec](#org28a487a)        4.  [GRPharoLating1Codec](#orgf24c784)        5.  [GRPharoUtf8Codec](#orge9acadd)    4.  [Contexts](#orgddb608d)        1.  [WAContextTest](#org58cea57)        2.  [WARequestContext](#orgd7e993f)    5.  [Requests](#org4f4ca89)        1.  [WARequest](#org0d6e573)    6.  [Responses](#org371906d)        1.  [WAResponse](#orgfaf3db1)        2.  [WABufferedResponse](#org8e643b7)        3.  [WAComboResponse](#org8ae4bd2)        4.  [WAStreamedResponse](#org579c1d5)    7.  [Servers](#orgf2243e4)        1.  [WAServerAdaptor](#org7936194)        2.  [WAServerManager](#org6e95447)    8.  [Minor Stuff Below Here](#org472920c)        1.  [WACookie](#org728b2e8)        2.  [WARequestCookie](#orge392bd4)        3.  [WAMergedRequestFields](#orge221f51)    9.  [Bibliography](#org8fc1edb)<a id="org6e17110"></a># Seaside<a id="org0108259"></a>## Introduction    Working Notes of an "in depth" study of the Seaside guts and patterns.<a id="orgdd7e9e4"></a>## Followups        Write a mockups of     WAComboResponse    WAStreamedResponse<a id="org241f544"></a>## Codecs    DECODING: Outside Data Converted Into the Image    ENCODING: Image data sent to outside the Image    When a WAServerAdaptor is spun up, it has a GRNullCodec as its default.<a id="org1bec414"></a>### GRCodec            A codec defines how Seaside communicates without the outside world and how outside data is converted into the image (decoding)     and back outside the image (encoding).         The codec is essentially a stream factory that provides wrappers around standard streams. All streams do support binary mode for non-converted transfer.<a id="org2d8bc93"></a>### GRNullCodec    GRObject subclass: #GRCodec        The null codec always returns the original streams.     It assumes that the outside world uses the same encoding as the inside world.     This is highly efficient as no transformation is applied to the data, but has its drawbacks.<a id="org28a487a"></a>### GRGenericCodec    GRCodec subclass: #GRPharoGenericCodec<a id="orgf24c784"></a>### GRPharoLating1Codec    GRNullCodec subclass: #GRPharoLatin1Codec            A GRPharoLatin1Codec is a WACodec optimized for ISO-8859-1 (direct byte to character mapping).<a id="orge9acadd"></a>### GRPharoUtf8Codec    GRCodec subclass: #GRPharoUtf8Codec        A WAUtf8Codec is a WACodec optimized for UTF-8.<a id="orgddb608d"></a>## Contexts<a id="org58cea57"></a>### WAContextTest<a id="orgd7e993f"></a>### WARequestContext    WARequestContext request: (WARequest new) response:  (WABufferedResponse new)  codec: ( GRNullCodec new)<a id="org4f4ca89"></a>## Requests<a id="org0d6e573"></a>### WARequest        WAObject subclass: #WARequest  has no children        I am a server independent http request object. Instance of me can be aquired through WAObject >> #currentRequest.        Instance Variables    	method:			<String>    	uri:					<WAUrl>    	version:				<WAHttpVersion>    	remoteAddress:	<String>    	headers:			<Dictionary<String, String>>    	cookies:			<Collection<WARequestCookie>>    	body:				<String>    	postFields:			<WARequestFields>    	sslSessionId:		<String>    			    method    	- the HTTP method, should be upper case. In general only 'GET' and 'POST' are encountered in Seaside. SqueakSource also supports 'PUT'.		        uri    	- The request url without parameters. For example if the client requested 'http://www.google.com/search?q=seaside' then the contents of url would be '/search'. To get the parameters use #fields. This url is fully decoded. Use the #host method to get the host name. Dependening on the server adapter the #scheme may be 'http' or 'https' if the original request was HTTPS.    	    version    	- The version of this request.    	    remoteAddress    	- The IP address of the client. If the server is behind a reverse proxy then this is '127.0.0.1'. This could in theory also be an IPv6 address.        headers    	- The header of the HTTP request. This is a Dictionary mapping lowercase strings to other strings.    	    cookies    	- The collection of cookies (instance of WARequestCookie) the client sent. Note not all clients support all fields. E.g. you might send a path but the client might not return it. Note there can be several cookies with the same key but a different domain or path. See the #cookiesAt: method.    	    body    	- The undecoded, raw request body as a String, may be nil. See the "accessing-body" protocol for accessing it.    	    postFields    	- The HTTP POST request parameters. In general this is a dictionary mapping Strings to Strings. In the case of multivalued paramters multiple mappings may exist.    	    sslSessionId    	- The SSL session id. This is an opaque string. It is not present if the request wasn't made over SSL (or TLS) or the server adaptor does not support this feature.<a id="org371906d"></a>## Responses<a id="orgfaf3db1"></a>### WAResponse                WAObject subclass: #WAResponse . I have children                A WAResponse is an abstract HTTP response objects. It is independent of the used server adapter.    See class side initialize protocol for all the responses from the server.<a id="org8e643b7"></a>### WABufferedResponse                WAObject subclass: #WAResponse subclass: WABufferedResponse            A WABufferedResponse is a concrete implementation of a HTTP response. Its contentsStream is used to represent the body of the message.        Instance Variables    	contentsStream:		<WriteStream> The contents of this message.            Basically a wrapper on a stream that obtains its headers from the parent.<a id="org8ae4bd2"></a>### WAComboResponse                WAObject subclass: #WAResponse subclass: WAComboResponse        WAComboResponse is a combination of a buffered and a streaming response. By default, WAComboResponse will buffer the entire response to be sent at the end of the request processing cycle. If streaming is desired, the response can be flushed by sending it the #flush message. Flushing a response will sent all previously buffered data using chunked transfer-encoding (which preserves persistent connections). Clients can flush the response as often as they want at appropriate points in their response generation; everything buffered up to that point will be sent. For example, a search results page might use something like:        renderContentOn: aCanvas    	"Render the search page"        	self renderSearchLabelOn: aCanvas.    	self requestContext request flush. "flush before starting search to give immediate feedback"        	self searchResultsDo: [ :result |    		self renderSearchResult: result on: aCanvas.    		self requestContext request flush "flush after each search result" ]        After a response has been flushed once, header modifications are no longer possible and will raise a WAIllegalStateException.        Server adaptors need to be aware that a committed response must be closed, when complete. An uncommitted response should be handled as usual by the server adapter.        on the TODO, I will investigate this more, later<a id="org579c1d5"></a>### WAStreamedResponse    WAObject subclass: #WAResponse subclass: WAStreamedResponse        A WAStreamedResponse is a HTTP response that directly writes to an external write stream. This response class is used to implement efficient HTTP response streaming, as it can directly write do the socket while content is still generated.        Instance Variables    	committed:		<Boolean>	Whether the status and header was written to the stream.    	externalStream:		<WriteStream>	The external stream to write to.<a id="orgf2243e4"></a>## Servers<a id="org7936194"></a>### WAServerAdaptor<a id="org6e95447"></a>### WAServerManager<a id="org472920c"></a>## Minor Stuff Below Here<a id="org728b2e8"></a>### WACookie                I represent a cookie, a piece of information that is stored on the client and read and writable by the server. I am basically a key/value pair of strings.    You can never trust information in a cookie, the client is free to edit it.    I model only a part of the full cookie specification.        Browser support:    http://www.mnot.net/blog/2006/10/27/cookie_fun        Netscape spec    http://cgi.netscape.com/newsref/std/cookie_spec.html        Cookie spec    http://tools.ietf.org/html/rfc2109        Cookie 2 spec    https://tools.ietf.org/html/rfc6265        HttpOnly    http://msdn2.microsoft.com/en-us/library/ms533046.aspx    https://bugzilla.mozilla.org/show_bug.cgi?id=178993        Compared to WARequestCookie I represent the information that is sent to the user agent.<a id="orge392bd4"></a>### WARequestCookie    A WARequestCookie is the cookie the user agent sent to the server.        Instance Variables    	domain:			<String>    	key:			<String>    	path:			<String>    	pathEncoded:	<String>    	ports:			<Collection<Integer>>    	value:			<String>    	version:			<Integer>        domain    	- xxxxx        key    	- xxxxx        path    	- According to https://tools.ietf.org/html/rfc6265#section-5.1.4 user-agents must use an algorithm equivalent to the following one:      1.  Let uri-path be the path portion of the request-uri if such a           portion exists (and empty otherwise).  For example, if the           request-uri contains just a path (and optional query string),           then the uri-path is that path (without the %x3F ("?") character           or query string), and if the request-uri contains a full           absoluteURI, the uri-path is the path component of that URI.           2.  If the uri-path is empty or if the first character of the uri-           path is not a %x2F ("/") character, output %x2F ("/") and skip           the remaining steps.           3.  If the uri-path contains no more than one %x2F ("/") character,           output %x2F ("/") and skip the remaining step.           4.  Output the characters of the uri-path from the first character up           to, but not including, the right-most %x2F ("/").        ports    	- xxxxx        value    	- xxxxx        version    	- the version of the cookie specification supported, currently only 1 is known<a id="orge221f51"></a>### WAMergedRequestFields        Provides a read-only view onto multiple dictionaries. Note that this can lead to to duplicated keys that can only retrieved by iterating over all the associations.<a id="org8fc1edb"></a>## Bibliography    https://github.com/seasidest